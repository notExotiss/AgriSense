"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[850],{3945:function(e,t,r){r.d(t,{Z:function(){return p}});var a=r(5893),n=r(7294),i=r(1664),o=r.n(i),s=r(7716),l=r(6789),d=r(1352),c=r(7232),u=r(7497),f=r(1571),h=r(8532),m=r(250);function x(){let[e,t]=(0,n.useState)(!1),{theme:r,setTheme:i}=(0,f.F)();if((0,n.useEffect)(()=>{t(!0)},[]),!e)return(0,a.jsx)(u.z,{variant:"ghost",size:"icon","aria-label":"Toggle theme",children:(0,a.jsx)(h.Z,{className:"h-4 w-4"})});let o="dark"===r;return(0,a.jsx)(u.z,{variant:"ghost",size:"icon","aria-label":"Toggle theme",onClick:()=>i(o?"light":"dark"),children:o?(0,a.jsx)(h.Z,{className:"h-4 w-4"}):(0,a.jsx)(m.Z,{className:"h-4 w-4"})})}let g=[{href:"/",label:"Home"},{href:"/dashboard",label:"Dashboard"},{href:"/plots",label:"Plots"},{href:"/account",label:"Account"}];function p(){let[e,t]=n.useState([]),[r,i]=n.useState(!1),[f,h]=n.useState(!1);n.useEffect(()=>{let e=e=>{t(Array.isArray(e.detail)?e.detail:[])};return window.addEventListener("agrisense:alerts",e),()=>window.removeEventListener("agrisense:alerts",e)},[]);let m=e.filter(e=>"critical"===e.type).length;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("header",{className:"liquid-glass sticky top-0 z-40 border-b border-border bg-background/95 backdrop-blur",children:[(0,a.jsxs)("div",{className:"mx-auto flex h-16 w-full max-w-7xl items-center justify-between px-4 sm:px-6",children:[(0,a.jsxs)(o(),{href:"/",className:"inline-flex items-center gap-2",children:[(0,a.jsx)("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-xl bg-primary text-primary-foreground",children:(0,a.jsx)(s.Z,{className:"h-5 w-5"})}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"block text-sm font-semibold leading-none text-foreground",children:"AgriSense"}),(0,a.jsx)("span",{className:"block text-[11px] uppercase tracking-[0.16em] text-muted-foreground",children:"Field Ops"})]})]}),(0,a.jsx)("nav",{className:"hidden items-center gap-5 md:flex",children:g.map(e=>(0,a.jsx)(o(),{href:e.href,className:"text-sm font-medium text-muted-foreground transition hover:text-primary",children:e.label},e.href))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>h(e=>!e),className:"relative inline-flex h-10 w-10 items-center justify-center rounded-xl border border-border bg-card text-muted-foreground hover:border-primary/40 hover:text-foreground","aria-label":"Open alerts",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),e.length>0&&(0,a.jsx)("span",{className:"absolute -right-1 -top-1 rounded-full bg-rose-600 px-1.5 py-0.5 text-[10px] font-semibold text-white",children:m||e.length})]}),(0,a.jsx)(x,{}),(0,a.jsx)(u.z,{variant:"outline",size:"icon",className:"md:hidden",onClick:()=>i(e=>!e),children:r?(0,a.jsx)(d.Z,{className:"h-4 w-4"}):(0,a.jsx)(c.Z,{className:"h-4 w-4"})})]})]}),r&&(0,a.jsx)("nav",{className:"border-t border-border bg-background px-4 py-3 md:hidden",children:(0,a.jsxs)("div",{className:"space-y-2",children:[g.map(e=>(0,a.jsx)(o(),{href:e.href,onClick:()=>i(!1),className:"block rounded-lg px-3 py-2 text-sm font-medium text-muted-foreground hover:bg-muted hover:text-primary",children:e.label},e.href)),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)(x,{})})]})})]}),f&&(0,a.jsxs)("aside",{className:"liquid-glass fixed right-4 top-20 z-50 w-[min(95vw,26rem)] rounded-2xl border border-border bg-card shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-border px-4 py-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-foreground",children:"Alert Center"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active agronomy and system alerts"})]}),(0,a.jsx)("button",{onClick:()=>h(!1),className:"text-muted-foreground hover:text-foreground",children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"max-h-80 space-y-2 overflow-auto p-3",children:[!e.length&&(0,a.jsx)("p",{className:"rounded-lg bg-muted p-3 text-sm text-muted-foreground",children:"No active alerts."}),e.map((e,t)=>(0,a.jsxs)("article",{className:"critical"===e.type?"alert-card alert-card-critical":"alert-card alert-card-warning",children:[(0,a.jsx)("p",{className:"alert-title",children:e.message||"Alert"}),(0,a.jsx)("p",{className:"alert-copy",children:e.details||"No additional details provided."}),e.plotName&&(0,a.jsx)("p",{className:"alert-meta",children:e.plotName})]},"".concat(e.id||t)))]})]})]})}},5133:function(e,t,r){var a=r(5893),n=r(7294);t.Z=e=>{let{data:t,title:r="NDVI Time Series",height:i=300,showConfidence:o=!1,showCloudCover:s=!1}=e,l=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!l.current||!t.length)return;let e=l.current,a=e.getContext("2d");if(!a)return;e.width=e.offsetWidth*window.devicePixelRatio,e.height=i*window.devicePixelRatio,a.scale(window.devicePixelRatio,window.devicePixelRatio),a.clearRect(0,0,e.offsetWidth,i);let n={top:20,right:40,bottom:40,left:60},d=e.offsetWidth-n.left-n.right,c=i-n.top-n.bottom,u=t.map(e=>new Date(e.date)),f=t.map(e=>e.ndvi),h=new Date(Math.min(...u.map(e=>e.getTime()))),m=new Date(Math.max(...u.map(e=>e.getTime()))),x=Math.min(...f),g=Math.max(...f),p=g-x,b=x-.1*p,v=g+.1*p,y=e=>n.left+(e.getTime()-h.getTime())/(m.getTime()-h.getTime())*d,w=e=>n.top+c-(e-b)/(v-b)*c;a.strokeStyle="#e0e0e0",a.lineWidth=1;for(let e=0;e<=5;e++){let t=n.top+c/5*e;a.beginPath(),a.moveTo(n.left,t),a.lineTo(n.left+d,t),a.stroke()}for(let e=0;e<=5;e++){let t=n.left+d/5*e;a.beginPath(),a.moveTo(t,n.top),a.lineTo(t,n.top+c),a.stroke()}if(o&&t.some(e=>e.confidence)){a.fillStyle="rgba(0, 123, 255, 0.1)",a.beginPath(),t.forEach((e,t)=>{let r=y(new Date(e.date)),n=e.confidence||.9,i=w(e.ndvi+(1-n)*.1);0===t?a.moveTo(r,i):a.lineTo(r,i)});for(let e=t.length-1;e>=0;e--){let r=t[e],n=y(new Date(r.date)),i=r.confidence||.9,o=w(r.ndvi-(1-i)*.1);a.lineTo(n,o)}a.closePath(),a.fill()}a.strokeStyle="#007bff",a.lineWidth=2,a.beginPath(),t.forEach((e,t)=>{let r=y(new Date(e.date)),n=w(e.ndvi);0===t?a.moveTo(r,n):a.lineTo(r,n)}),a.stroke(),a.fillStyle="#007bff",t.forEach(e=>{let t=y(new Date(e.date)),r=w(e.ndvi);a.beginPath(),a.arc(t,r,3,0,2*Math.PI),a.fill()}),a.strokeStyle="#333",a.lineWidth=2,a.beginPath(),a.moveTo(n.left,n.top+c),a.lineTo(n.left+d,n.top+c),a.stroke(),a.beginPath(),a.moveTo(n.left,n.top),a.lineTo(n.left,n.top+c),a.stroke(),a.fillStyle="#333",a.font="12px Arial",a.textAlign="center";for(let e=0;e<=5;e++){let t=new Date(h.getTime()+(m.getTime()-h.getTime())*(e/5)),r=n.left+d/5*e;a.fillText(t.toLocaleDateString(),r,n.top+c+20)}a.textAlign="right";for(let e=0;e<=5;e++){let t=b+e/5*(v-b),r=n.top+c-c/5*e;a.fillText(t.toFixed(2),n.left-10,r+4)}a.textAlign="center",a.font="bold 16px Arial",a.fillText(r,e.offsetWidth/2,20),s&&(a.font="12px Arial",a.textAlign="left",a.fillText("Cloud Cover:",n.left+d+10,n.top+20),t.forEach((e,t)=>{if(void 0!==e.cloudCover){let t=y(new Date(e.date)),r=w(e.ndvi),n=1-e.cloudCover/100;a.fillStyle="rgba(255, 0, 0, ".concat(n,")"),a.beginPath(),a.arc(t,r,5,0,2*Math.PI),a.fill()}}))},[t,i,o,s,r]),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)("canvas",{ref:l,style:{width:"100%",height:"".concat(i,"px")},className:"border rounded"})})}},7497:function(e,t,r){r.d(t,{z:function(){return l}});var a=r(5893),n=r(7294),i=r(2003),o=r(1966);let s=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:opacity-90",secondary:"bg-secondary text-secondary-foreground hover:opacity-90",outline:"border bg-transparent hover:bg-accent hover:text-accent-foreground",ghost:"hover:bg-accent hover:text-accent-foreground",destructive:"bg-destructive text-destructive-foreground hover:opacity-90"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,...l}=e;return(0,a.jsx)("button",{className:(0,o.cn)(s({variant:n,size:i,className:r})),ref:t,...l})});l.displayName="Button"},1966:function(e,t,r){r.d(t,{cn:function(){return i}});var a=r(512),n=r(8388);function i(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}},8704:function(e,t,r){r.d(t,{$D:function(){return o},GY:function(){return a},eR:function(){return d},k1:function(){return s},pb:function(){return l}});class a extends Error{constructor(e,t,r){super(e),this.name="ApiClientError",this.code=t,this.status=r}}async function n(e){try{return await e.json()}catch(e){return{}}}async function i(e,t){let r=await fetch(e,t),i=await n(r);if(!r.ok)throw new a((null==i?void 0:i.message)||(null==i?void 0:i.error)||"Request failed (".concat(r.status,")"),(null==i?void 0:i.error)||"request_failed",r.status);return i}function o(e){return e instanceof a?"invalid_auth"===e.code?"Authentication token is invalid or expired. Sign in again and retry.":401===e.status?"Sign-in expired. Please sign in again.":403===e.status?"You do not have access to this plot.":408===e.status?"Request timed out. Retry in a few seconds.":413===e.status||"plot_payload_too_large"===e.code?"Plot snapshot is too large to save. Re-run analysis and retry.":"invalid_geometry"===e.code?"Selected area geometry is invalid. Redraw the AOI and retry.":"invalid_payload"===e.code?"Plot payload contains unsupported values.":503===e.status||"firebase_admin_misconfigured"===e.code?"Server save service is misconfigured. Check Firebase Admin credentials.":"validation_failed"===e.code?"Some required fields are missing.":e.message||"Save failed. Please retry.":"Network issue. Check connection and retry."}async function s(e){let t=await i("/api/items",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});return Array.isArray(t.items)?t.items:[]}async function l(e,t){return await i("/api/items",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(t)})}async function d(e,t){await i("/api/plots/".concat(t),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}},6394:function(e,t,r){r.d(t,{I8:function(){return d},oy:function(){return c}});var a=r(3977),n=r(2370);let i={apiKey:"AIzaSyBkGPzwLd_hQj-yPB7mxNijPW89iDXym2A",authDomain:"brightbite-81e92.firebaseapp.com",projectId:"brightbite-81e92",storageBucket:"brightbite-81e92.firebasestorage.app",messagingSenderId:"273197668689",appId:"1:273197668689:web:fc5eee2714d4bb89365b70"},o=Object.values(i).every(e=>"string"==typeof e&&e.length>0);function s(){return o?(0,a.C6)().length?(0,a.Mq)():(0,a.ZF)(i):null}let l=null;s();let d=function(){if(!o)return null;if(l)return l;let e=s();return e?l=(0,n.v0)(e):null}(),c=o}}]);