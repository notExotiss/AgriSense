"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{9963:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});var r=n(5893),a=n(5715),o=n(943),l=n(2013),i=n(8798),s=n(577),u=n(2604);n(8570),n(3337),n(1787);var c=n(5243),d=n.n(c),g=n(7294);function m(e){let{bbox:t,onBboxChange:n,polygon:c,onPolygonChange:m,ndviPng:f,ndviBounds:p,hotspots:h,processedOverlayUrl:y,smoothOverlay:b=!0,overlayOpacity:w=.85}=e,x=(0,g.useRef)(null);(0,g.useEffect)(()=>{let e=x.current;if(!e)return;let t=new(d()).FeatureGroup;e.addLayer(t);let r=new(d()).Control.Draw({draw:{polygon:!0,rectangle:!0,polyline:!1,circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:t}});return e.addControl(r),e.on(d().Draw.Event.CREATED,e=>{let r=e.layer;if(t.addLayer(r),r.getBounds){let e=r.getBounds(),t=e.getWest(),a=e.getSouth(),o=e.getEast(),l=e.getNorth();n&&n([t,a,o,l])}if(r.getLatLngs){let e=r.getLatLngs()[0]||[];m&&m(e)}}),()=>{e.removeControl(r),e.removeLayer(t)}},[x.current]),(0,g.useEffect)(()=>{let e=x.current;if(e)try{if(p&&Array.isArray(p)&&4===p.length){let t=d().latLngBounds([p[1],p[0]],[p[3],p[2]]);e.fitBounds(t,{padding:[20,20]});return}if(t&&Array.isArray(t)&&4===t.length){let n=d().latLngBounds([t[1],t[0]],[t[3],t[2]]);e.fitBounds(n,{padding:[20,20]});return}if(c&&c.length){let t=d().latLngBounds(c);e.fitBounds(t,{padding:[20,20]})}}catch(e){}},[JSON.stringify(p),JSON.stringify(t),JSON.stringify(c)]);let j=a.h,k=o.v,E=l.I,L=(0,g.useMemo)(()=>y&&y.length?y:f&&f.length?"data:image/png;base64,".concat(f):null,[y,f]);(0,g.useEffect)(()=>{if(!b)return;let e="leaflet-image-smooth-css";if(document.getElementById(e))return;let t=document.createElement("style");return t.id=e,t.textContent="\n      .leaflet-image-smooth {\n        image-rendering: auto !important;\n        -ms-interpolation-mode: bicubic !important; /* IE */\n        image-rendering: -webkit-optimize-contrast !important;\n        will-change: transform;\n      }\n      .leaflet-image-smooth.smooth-filter {\n        filter: blur(0.7px) contrast(0.98) saturate(1.05);\n        /* slight blur to remove thin spiky lines, small contrast/saturation tweak */\n      }\n    ",document.head.appendChild(t),()=>{}},[b]);let B=L&&p&&4===p.length?(0,r.jsx)(k,{url:L,bounds:[[p[1],p[0]],[p[3],p[2]]],opacity:w,crossOrigin:"anonymous",className:"leaflet-image-smooth ".concat(b?"smooth-filter":""),style:{imageRendering:"auto",transform:"translateZ(0)"}}):null;return(0,r.jsxs)(j,{ref:x,center:[40,-95],zoom:5,style:{height:"100%",width:"100%",borderRadius:12,overflow:"hidden",zIndex:0},children:[(0,r.jsx)(E,{attribution:"\xa9 OpenStreetMap contributors",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),B,c&&c.length>0&&(0,r.jsx)(i.m,{positions:c,pathOptions:{color:"#16a34a",weight:2}}),(h||[]).map((e,t)=>(0,r.jsx)(s.J,{position:e.position,children:(0,r.jsx)(u.G,{children:e.label})},t))]})}delete d().Icon.Default.prototype._getIconUrl,d().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"})}}]);