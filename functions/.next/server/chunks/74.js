"use strict";exports.id=74,exports.ids=[74],exports.modules={8074:(e,t,r)=>{r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{default:()=>s});var n=r(997),i=r(6689),l=r(2949),a=e([l]);l=(a.then?(await a)():a)[0];let s=({ndviData:e,bbox:t,onViewStateChange:r=()=>{},show3D:o=!1,layerType:a="scatter",location:s})=>{let d=(0,i.useRef)(null),c=(0,i.useRef)(null),h=(0,i.useRef)(null),p=(0,i.useRef)(null),x=(0,i.useRef)([]),u=(0,i.useRef)(!1),g=(0,i.useRef)({x:0,y:0}),[m,b]=(0,i.useState)("scatter"),[f,M]=(0,i.useState)(o),[v,y]=(0,i.useState)([]),[w,j]=(0,i.useState)({x:.5,y:0}),[S,k]=(0,i.useState)(1),[R,D]=(0,i.useState)(!1),[L,C]=(0,i.useState)({lat:40,lon:-95,name:"Selected Location"});(0,i.useEffect)(()=>{let e=()=>D(document.documentElement.classList.contains("dark"));e();let t=new MutationObserver(e);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]),(0,i.useEffect)(()=>{s?.lat&&s?.lon&&C({lat:s.lat,lon:s.lon,name:s.name||"Selected Location"})},[s?.lat,s?.lon,s?.name]),(0,i.useEffect)(()=>{B()},[L.lat,L.lon]);let B=()=>{let e=[];for(let t=0;t<60;t++)for(let r=0;r<60;r++){L.lat,L.lon;let o=Math.sqrt(Math.pow(t-30,2)+Math.pow(r-30,2)),n=.3+o/30*.5;n+=(Math.random()-.5)*.15;let i=Math.sin(.2*t)*Math.cos(.2*r)*.15+Math.sin(.1*t)*Math.cos(.15*r)*.1+Math.sin(.05*t)*Math.cos(.05*r)*.08;n+=i,n=Math.max(-.2,Math.min(1,n)),.05>Math.random()&&(n=.6>Math.random()?.85:-.15),e.push({x:(t-30)*2,y:(r-30)*2,ndvi:n,elevation:25*n,color:z(n),cityName:L.name})}y(e),j({x:.5,y:0}),k(1)},z=e=>{let t=Math.max(-1,Math.min(1,e));if(t<-.1){let e=(t+1)/.9;return[Math.floor(40+60*e),Math.floor(80+100*e),Math.floor(140+80*e)]}if(t<.05){let e=(t+.1)/.15;return[Math.floor(100+80*e),Math.floor(180+50*e),Math.floor(220-30*e)]}if(t<.15){let e=(t-.05)/.1;return[Math.floor(180+30*e),Math.floor(230-30*e),Math.floor(190-50*e)]}if(t<.3){let e=(t-.15)/.15;return[Math.floor(210-50*e),Math.floor(200-20*e),Math.floor(140-50*e)]}if(t<.5){let e=(t-.3)/.2;return[Math.floor(160-30*e),Math.floor(180+30*e),Math.floor(90-10*e)]}if(t<.7){let e=(t-.5)/.2;return[Math.floor(130-70*e),Math.floor(210-60*e),Math.floor(80+20*e)]}{let e=(t-.7)/.3;return[Math.floor(60+80*e),Math.floor(150-30*e),Math.floor(100-40*e)]}};(0,i.useEffect)(()=>{if(!d.current||0===v.length)return;let e=new l.Scene;e.background=new l.Color(R?1710618:15266037),c.current=e;let t=new l.PerspectiveCamera(60,d.current.clientWidth/d.current.clientHeight,.1,1e3);t.position.set(0,60,100),t.lookAt(0,0,0),h.current=t;let r=new l.WebGLRenderer({antialias:!0});r.setSize(d.current.clientWidth,d.current.clientHeight),d.current.innerHTML="",d.current.appendChild(r.domElement),p.current=r;let o=new l.AmbientLight(16777215,R?.5:.75);e.add(o);let n=new l.DirectionalLight(16777215,R?.6:.5);n.position.set(50,80,50),e.add(n);let i=new l.DirectionalLight(16777215,R?.3:.25);i.position.set(-50,40,-50),e.add(i);let a=new l.PlaneGeometry(100,100),s=new l.MeshPhongMaterial({color:R?855309:14215408,side:l.DoubleSide,transparent:!0,opacity:R?.6:.4}),x=new l.Mesh(a,s);x.rotation.x=-Math.PI/2,e.add(x);let u=new l.GridHelper(100,20,R?4473924:11587808,R?2763306:13164784);u.material.opacity=R?.4:.3,u.material.transparent=!0,e.add(u),E(e);let g=()=>{requestAnimationFrame(g),c.current&&(c.current.rotation.x=w.x,c.current.rotation.y=w.y,h.current&&(h.current.position.set(0,60/S,100/S),h.current.lookAt(0,0,0))),r.render(e,t)};g();let m=()=>{if(d.current&&h.current&&p.current){let e=d.current.clientWidth,t=d.current.clientHeight;h.current.aspect=e/t,h.current.updateProjectionMatrix(),p.current.setSize(e,t)}};return window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m),d.current&&r.domElement&&d.current.removeChild(r.domElement),r.dispose()}},[v,m,f,w,S,R]);let E=e=>{x.current.forEach(t=>e.remove(t)),x.current=[];let t=Math.sqrt(v.length);if("heatmap"===m||"scatter"===m){let r=new l.PlaneGeometry(2*t,2*t,t-1,t-1),o=r.attributes.position.array,n=[];for(let e=0;e<v.length;e++){let t=v[e];o[3*e+2]=f?1.5*t.elevation:.6*t.elevation,n.push(t.color[0]/255,t.color[1]/255,t.color[2]/255)}r.setAttribute("color",new l.Float32BufferAttribute(n,3)),r.computeVertexNormals();let i=new l.MeshPhongMaterial({vertexColors:!0,side:l.DoubleSide,flatShading:!1,shininess:R?15:20,specular:new l.Color(R?2236962:3355443),emissive:new l.Color(0),emissiveIntensity:0,reflectivity:.3}),a=new l.Mesh(r,i);a.rotation.x=-Math.PI/2,e.add(a),x.current.push(a),P(e,r,v,t)}else v.forEach(t=>{if("column"===m){let r=new l.Color(t.color[0]/255,t.color[1]/255,t.color[2]/255),o=f?Math.max(t.elevation,1):1,n=new l.CylinderGeometry(.4,.4,o,12),i=new l.MeshPhongMaterial({color:r}),a=new l.Mesh(n,i);a.position.set(t.x,o/2,t.y),e.add(a),x.current.push(a)}})},P=(e,t,r,o)=>{let n=t.attributes.position;[-.1,0,.1,.2,.3,.4,.5,.6,.7,.8].forEach(t=>{let i=[];for(let e=0;e<o-1;e++)for(let a=0;a<o-1;a++){let s=e*o+a,d=r[s],c=r[s+1],h=r[s+o];if(r[s+o+1],(d.ndvi-t)*(c.ndvi-t)<0){let e=(t-d.ndvi)/(c.ndvi-d.ndvi),r=n.getX(s),o=n.getY(s),a=n.getZ(s),h=n.getX(s+1),p=n.getY(s+1),x=n.getZ(s+1);i.push(new l.Vector3(r+(h-r)*e,o+(p-o)*e,a+(x-a)*e+.1))}if((d.ndvi-t)*(h.ndvi-t)<0){let e=(t-d.ndvi)/(h.ndvi-d.ndvi),r=n.getX(s),a=n.getY(s),c=n.getZ(s),p=n.getX(s+o),x=n.getY(s+o),u=n.getZ(s+o);i.push(new l.Vector3(r+(p-r)*e,a+(x-a)*e,c+(u-c)*e+.1))}}if(i.length>1){let t=new l.BufferGeometry().setFromPoints(i),r=new l.LineBasicMaterial({color:R?5592405:0,opacity:R?.25:.18,transparent:!0,linewidth:1}),o=new l.LineSegments(t,r);o.rotation.x=-Math.PI/2,e.add(o),x.current.push(o)}})},W=()=>{u.current=!1},F=v.length>0?v[0].cityName:s?.name||"Selected Location",V=v.map(e=>e.ndvi),I=V.length>0?Math.min(...V):0,T=V.length>0?Math.max(...V):0,N=V.length>0?V.reduce((e,t)=>e+t,0)/V.length:0;return(0,n.jsxs)("div",{style:{height:"600px",width:"100%",position:"relative"},children:[n.jsx("div",{ref:d,onMouseDown:e=>{u.current=!0,g.current={x:e.clientX,y:e.clientY}},onMouseMove:e=>{if(!u.current)return;let t=e.clientX-g.current.x,r=e.clientY-g.current.y;j(e=>({x:e.x+.01*r,y:e.y+.01*t})),g.current={x:e.clientX,y:e.clientY}},onMouseUp:W,onMouseLeave:W,onWheel:e=>{e.preventDefault();let t=e.deltaY>0?.9:1.1;k(e=>Math.max(.5,Math.min(3,e*t)))},style:{width:"100%",height:"100%",cursor:u.current?"grabbing":"grab",borderRadius:"8px",overflow:"hidden"}}),(0,n.jsxs)("div",{style:{position:"absolute",top:"10px",right:"10px",background:R?"rgba(17, 24, 39, 0.95)":"rgba(255, 255, 255, 0.95)",padding:"15px",borderRadius:"8px",boxShadow:"0 2px 12px rgba(0,0,0,0.15)",minWidth:"200px",backdropFilter:"blur(10px)",color:R?"#e5e7eb":"#333"},children:[n.jsx("div",{style:{marginBottom:"12px",fontWeight:"bold",fontSize:"16px"},children:"Map Controls"}),n.jsx("div",{style:{marginBottom:"8px",fontSize:"13px",color:R?"#94a3b8":"#666"},children:"Layer Type:"}),(0,n.jsxs)("select",{value:m,onChange:e=>b(e.target.value),style:{marginBottom:"12px",width:"100%",padding:"8px",borderRadius:"4px",border:R?"1px solid #555":"1px solid #ddd",fontSize:"13px",background:R?"#1f2937":"white",color:R?"#e5e7eb":"#333"},children:[n.jsx("option",{value:"heatmap",children:"Topographic Map"}),n.jsx("option",{value:"scatter",children:"Scatter Points"}),n.jsx("option",{value:"column",children:"3D Columns"})]}),(0,n.jsxs)("label",{style:{display:"flex",alignItems:"center",fontSize:"13px",marginBottom:"12px"},children:[n.jsx("input",{type:"checkbox",checked:f,onChange:e=>M(e.target.checked),style:{marginRight:"8px"}}),"Full Height (Toggle for more/less depth)"]}),(0,n.jsxs)("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:R?"1px solid #444":"1px solid #ddd"},children:[(0,n.jsxs)("div",{style:{fontSize:"12px",color:R?"#94a3b8":"#666",marginBottom:"4px"},children:["Zoom: ",S.toFixed(2),"x"]}),n.jsx("button",{onClick:()=>j({x:.5,y:0}),style:{padding:"6px 10px",fontSize:"12px",background:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",width:"100%",marginTop:"4px"},children:"Reset View"})]})]}),(0,n.jsxs)("div",{style:{position:"absolute",top:"10px",left:"10px",background:R?"rgba(17, 24, 39, 0.95)":"rgba(255, 255, 255, 0.95)",padding:"15px",borderRadius:"8px",fontSize:"13px",maxWidth:"250px",boxShadow:"0 2px 12px rgba(0,0,0,0.15)",backdropFilter:"blur(10px)",color:R?"#e5e7eb":"#333"},children:[(0,n.jsxs)("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"16px"},children:[F," - NDVI Analysis"]}),(0,n.jsxs)("div",{style:{marginBottom:"4px"},children:[n.jsx("strong",{children:"Layer:"})," ","column"===m?"3D Columns":"scatter"===m?"Scatter Points":"Topographic Map"]}),(0,n.jsxs)("div",{style:{marginBottom:"4px"},children:[n.jsx("strong",{children:"3D Mode:"})," ",f?"On":"Off"]}),(0,n.jsxs)("div",{style:{marginBottom:"4px"},children:[n.jsx("strong",{children:"Data Points:"})," ",v.length.toLocaleString()]}),n.jsx("hr",{style:{margin:"8px 0",border:"none",borderTop:R?"1px solid #444":"1px solid #ddd"}}),(0,n.jsxs)("div",{style:{marginBottom:"4px"},children:[n.jsx("strong",{children:"Min NDVI:"})," ",I.toFixed(3)]}),(0,n.jsxs)("div",{style:{marginBottom:"4px"},children:[n.jsx("strong",{children:"Max NDVI:"})," ",T.toFixed(3)]}),(0,n.jsxs)("div",{children:[n.jsx("strong",{children:"Mean NDVI:"})," ",N.toFixed(3)]})]}),(0,n.jsxs)("div",{style:{position:"absolute",bottom:"10px",right:"10px",background:R?"rgba(17, 24, 39, 0.95)":"rgba(255, 255, 255, 0.95)",padding:"12px",borderRadius:"8px",fontSize:"12px",boxShadow:"0 2px 12px rgba(0,0,0,0.15)",backdropFilter:"blur(10px)",color:R?"#e5e7eb":"#333"},children:[n.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px",fontSize:"13px"},children:"NDVI Legend"}),[{color:[40,80,140],label:"Deep Water (<-0.1)"},{color:[100,180,220],label:"Shallow Water (0)"},{color:[180,230,190],label:"Coastal (0.05)"},{color:[210,200,140],label:"Low Veg (0.15)"},{color:[130,180,90],label:"Moderate (0.5)"},{color:[60,150,100],label:"Dense Veg (0.7)"},{color:[140,120,60],label:"Very Dense (>0.8)"}].map((e,t)=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"4px"},children:[n.jsx("div",{style:{width:"16px",height:"16px",background:`rgb(${e.color[0]}, ${e.color[1]}, ${e.color[2]})`,marginRight:"8px",borderRadius:"2px",border:R?"1px solid #555":"1px solid #ddd"}}),n.jsx("span",{children:e.label})]},t))]}),(0,n.jsxs)("div",{style:{position:"absolute",bottom:"10px",left:"10px",background:R?"rgba(17, 24, 39, 0.95)":"rgba(255, 255, 255, 0.95)",padding:"10px",borderRadius:"8px",fontSize:"11px",boxShadow:"0 2px 12px rgba(0,0,0,0.15)",backdropFilter:"blur(10px)",maxWidth:"200px",color:R?"#e5e7eb":"#333"},children:[n.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Controls:"}),n.jsx("div",{children:"• Click + drag to rotate"}),n.jsx("div",{children:"• Scroll to zoom"}),n.jsx("div",{children:"• Toggle 3D for elevation"}),n.jsx("div",{children:"• Reset view button available"})]})]})};o()}catch(e){o(e)}})}};