"use strict";(()=>{var t={};t.id=743,t.ids=[743],t.modules={145:t=>{t.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(t,e)=>{Object.defineProperty(e,"l",{enumerable:!0,get:function(){return function t(e,a){return a in e?e[a]:"then"in e&&"function"==typeof e.then?e.then(e=>t(e,a)):"function"==typeof e&&"default"===a?e:void 0}}})},1784:(t,e,a)=>{a.r(e),a.d(e,{config:()=>m,default:()=>c,routeModule:()=>p});var r={};a.r(r),a.d(r,{default:()=>l});var n=a(1802),o=a(7153),i=a(6249);let d=process.env.OPENWEATHER_API_KEY||"demo_key",s="https://api.openweathermap.org/data/2.5";async function u(t,e){if("demo_key"===d)return{name:`Location (${t.toFixed(2)}, ${e.toFixed(2)})`,country:"",state:""};try{let a=await fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${t}&lon=${e}&limit=1&appid=${d}`);if(!a.ok)throw Error(`Geocoding API error: ${a.status}`);let r=await a.json();if(r&&r.length>0)return{name:r[0].name||"Unknown Location",country:r[0].country||"",state:r[0].state||""};return{name:"Unknown Location",country:"",state:""}}catch(t){return console.error("Geocoding error:",t),{name:"Unknown Location",country:"",state:""}}}async function h(t,e){try{let a=await u(t,e),r=await fetch(`${s}/weather?lat=${t}&lon=${e}&appid=${d}&units=imperial`);if(!r.ok){let t=await r.text();throw Error(`OpenWeather API error: ${r.status} - ${t}`)}let n=await r.json(),o=await fetch(`${s}/forecast?lat=${t}&lon=${e}&appid=${d}&units=imperial`);if(!o.ok){let t=await o.text();throw Error(`OpenWeather Forecast API error: ${o.status} - ${t}`)}let i=await o.json(),h={};i.list.forEach(t=>{let e=new Date(1e3*t.dt).toISOString().split("T")[0];h[e]||(h[e]=[]),h[e].push(t)});let l=Object.keys(h).map(t=>{let e=h[t],a=e.map(t=>t.main.temp),r=e.find(t=>{let e=new Date(1e3*t.dt).getHours();return e>=12&&e<=15})||e[Math.floor(e.length/2)],n=e.reduce((t,e)=>t+(e.rain?.["3h"]||0)+(e.snow?.["3h"]||0),0),o=e.reduce((t,e)=>t+e.main.humidity,0)/e.length,i=e.reduce((t,e)=>t+e.wind.speed,0)/e.length;return{date:t,temp_max:Math.round(Math.max(...a)),temp_min:Math.round(Math.min(...a)),condition:r.weather[0].main,description:r.weather[0].description,precipitation:Math.round(10*n)/10,humidity:Math.round(o),windSpeed:Math.round(i),icon:r.weather[0].icon}});return{location:{lat:parseFloat(t.toFixed(4)),lon:parseFloat(e.toFixed(4)),name:a.name,country:a.country,state:a.state},current:{temperature:Math.round(n.main.temp),humidity:n.main.humidity,windSpeed:Math.round(n.wind.speed),condition:n.weather[0].main,description:n.weather[0].description,precipitation:(n.rain?.["1h"]||0)+(n.snow?.["1h"]||0),uvIndex:Math.round(5*Math.random()+3),feelsLike:Math.round(n.main.feels_like),pressure:n.main.pressure,visibility:Math.round((n.visibility||0)/1609.34),icon:n.weather[0].icon},forecast:l.slice(0,7)}}catch(t){throw console.error("Weather API error:",t),t}}async function l(t,e){if("POST"!==t.method)return e.status(405).end();try{let a,r;let{bbox:n,date:o,location:i}=t.body||{};if(i&&i.lat&&i.lon)a=i.lat,r=i.lon;else{if(!(n&&Array.isArray(n))||4!==n.length)return e.status(400).json({error:"location_required",message:"Either bbox [minx,miny,maxx,maxy] or location {lat, lon} is required"});let[t,o,i,d]=n;a=(o+d)/2,r=(t+i)/2}if("demo_key"===d){let t=await u(a,r),n={location:{lat:parseFloat(a.toFixed(4)),lon:parseFloat(r.toFixed(4)),name:t.name,country:t.country,state:t.state},current:{temperature:Math.round(30*Math.random()+50),humidity:Math.round(30*Math.random()+60),windSpeed:Math.round(10*Math.random()+5),condition:Math.random()>.7?"Clouds":Math.random()>.4?"Clear":"Rain",description:Math.random()>.7?"overcast clouds":Math.random()>.4?"clear sky":"light rain",precipitation:Math.round(50*Math.random())/10,uvIndex:Math.round(5*Math.random()+3),feelsLike:Math.round(30*Math.random()+50),pressure:Math.round(200*Math.random()+1e3),visibility:Math.round(5*Math.random()+5),icon:Math.random()>.5?"01d":"02d"},forecast:Array.from({length:7}).map((t,e)=>{let a=["Clear","Clouds","Rain","Snow"],r=a[Math.floor(Math.random()*a.length)];return{date:new Date(Date.now()+864e5*e).toISOString().split("T")[0],temp_max:Math.round(10*Math.random()+70),temp_min:Math.round(10*Math.random()+50),condition:r,description:"Clear"===r?"clear sky":"Clouds"===r?"overcast clouds":"light rain",precipitation:Math.round(100*Math.random())/10,humidity:Math.round(30*Math.random()+60),windSpeed:Math.round(10*Math.random()+5),icon:"Clear"===r?"01d":"Clouds"===r?"02d":"10d"}})};return e.status(200).json({data:n,message:"Demo weather data provided (add OPENWEATHER_API_KEY for real data)"})}let s=await h(a,r);return e.status(200).json({data:s,message:"Real weather data from OpenWeatherMap"})}catch(t){return console.error("weather API error",t?.message||t,{stack:t?.stack}),e.status(500).json({error:"weather_fetch_failed",message:String(t?.message||t)})}}let c=(0,i.l)(r,"default"),m=(0,i.l)(r,"config"),p=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/weather",pathname:"/api/weather",bundlePath:"",filename:""},userland:r})},7153:(t,e)=>{var a;Object.defineProperty(e,"x",{enumerable:!0,get:function(){return a}}),function(t){t.PAGES="PAGES",t.PAGES_API="PAGES_API",t.APP_PAGE="APP_PAGE",t.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(t,e,a)=>{t.exports=a(145)}};var e=require("../../webpack-api-runtime.js");e.C(t);var a=e(e.s=1784);module.exports=a})();